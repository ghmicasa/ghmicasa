<script>
  function isVisible(element) {
    return element.offsetWidth > 0 && element.offsetHeight > 0;
  }

  function shuffleElements() {
    const parentElements = document.querySelectorAll('.randomize');

    parentElements.forEach((parentElement) => {
      const children = [...parentElement.children];
      children.sort(() => Math.random() - 0.5);
      parentElement.innerHTML = ''; // Clear existing children
      children.forEach((child) => parentElement.appendChild(child));
    });
  }

  function updateVisibleElements() {
    const parentElements = document.querySelectorAll('.randomize');

    parentElements.forEach((parentElement) => {
      [...parentElement.children].forEach((element) => {
        if (isVisible(element)) {
          if (element.dataset.src) {
            element.src = element.dataset.src;
          }

          element.querySelectorAll('img')?.forEach((imgElement) => {
            if (imgElement.dataset.src) {
              imgElement.src = imgElement.dataset.src;
            }
          });

          element.querySelectorAll('*')?.forEach((subElement) => {
            if (subElement.dataset.style) {
              subElement.style.cssText = subElement.dataset.style;
            }
          });
        }
      });
    });
  }

  // Execute both functions
  shuffleElements();
  updateVisibleElements();
</script>